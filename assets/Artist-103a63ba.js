import{o as C,r as n,p as k,g as c,a as d,j as t,I as D,d as I,M as S,L as h,e as m,m as U,B as Y,F as j,s as z,k as p}from"./index-fb9d91aa.js";import{d as A}from"./dayjs.min-81bb113f.js";import{P as L}from"./AppBack-1f281241.js";import{u as T,c as B}from"./clamp-0151734b.js";import{u as F}from"./useScrollTop-09fc1e57.js";const O=()=>{const{artistid:l}=C(),u=n.useRef(null),{isShowModal:x,isShowContent:f,onModalOpen:g,onModalClose:b}=k(),{data:r}=c(`/api/artists?id=${l}`,()=>p.get(`/api/artists?id=${l}`).then(e=>e.data).then(e=>{const{artist:i,hotSongs:a}=e;return{artist:{imgUrl:i.picUrl,title:i?.alias?.[0]??"",id:i.id,artistName:i.name,type:"artist",desc:i.briefDesc},songs:a.map(s=>({imgUrl:s.al.picUrl,title:s.name,desc:s.al.name,artistId:s.ar[0].id,albumId:s.al.id,artistName:s.ar.length?[...s.ar].reverse().reduce((M,$)=>`${$.name} ${M}`,""):"",albumName:s.al.name,type:"song",id:s.id}))}})),{data:y}=c(`/api/artist/album?id=${l}&offset=0&limit=4`,()=>p.get(`/api/artist/album?id=${l}&offset=0&limit=4`).then(e=>e.data).then(e=>{const{hotAlbums:i}=e;return i.map(a=>({imgUrl:a.picUrl,title:a.name,publishTime:a.publishTime?A(new Date(a.publishTime),"YYYY-MM-DD").format("YYYY-MM-DD"):null,type:"bigAlbum",albumId:a.id,id:a.id}))})),{data:o}=c(`/api/artist/mv?id=${l}&offset=0&limit=4`,()=>p.get(`/api/artist/mv?id=${l}&offset=0&limit=4`).then(e=>e.data).then(e=>{const{mvs:i}=e;return i.map(a=>({imgUrl:a.imgurl,title:a.name,id:a.id,desc:a.description,type:"mv"}))})),v=n.useCallback(e=>{const i=B(e,0,1);return i===0?2:Number(i.toFixed(2))},[]),w=n.useCallback(()=>u.current,[]),N=T(w,v);return F(),console.log(o),d("div",{className:" pt-8 px-4 pb-10",children:[x&&t(D,{isDynamic:!1,children:d("div",{className:I(" fixed left-0 top-0 p-9 text-base bg-mg text-fg pb-16 transition-opacity duration-300 z-[10000] w-full h-full",{" opacity-100":f," opacity-0":!f}),children:[t("div",{className:" min-h-[20px] max-h-[80%] overflow-y-auto mt-4 text-base leading-normal text-dg ",children:r?.artist?.desc}),t("div",{onClick:b,"data-close":"true",className:" absolute bottom-10 text-fg text-center text-4xl w-full left-0",children:"×"})]})}),t("div",{className:" fixed pt-6 px-4 pb-4 top-0 left-0 w-full z-[501] bg-mg",style:{opacity:N},children:t(L,{isBlack:!1,title:r?.artist?.artistName??"",style:{padding:0}})}),t("div",{className:" mt-16 sticky z-0 top-4 flex justify-center",children:t(S,{url:r?.artist?.imgUrl||"",className:" w-[134px] h-[134px] rounded-[50%]"})}),d("div",{className:" sticky py-8 bg-mg z-[5] overflow-hidden",ref:u,children:[t("div",{className:" mt-3 text-xl text-fg single_line w-full",children:`${r?.artist?.artistName} (${r?.artist?.title})`}),t("div",{className:" min-h-[20px] max-h-[86%] overflow-y-auto mt-5 text-base leading-snug text-dg two_lines ",onClick:g,children:r?.artist?.desc}),t(h,{to:`/artist/media/${l}/song`,children:t(m,{title:"热曲",showMore:!0})}),t(U,{list:r?.songs?.slice?.(0,5)??void 0,placeHolderCount:5,lazyAll:!0}),t(h,{to:`/artist/media/${l}/album`,children:t(m,{title:"热门专辑",showMore:!0})}),t(Y,{list:y??void 0,placeHolderCount:4}),!!o&&o?.length>0&&d(j,{children:[t(m,{title:"热门MV"}),t("div",{className:"flex flex-wrap  justify-between",children:t(z,{list:o??void 0,placeHolderCount:4})})]})]})]})};export{O as default};
