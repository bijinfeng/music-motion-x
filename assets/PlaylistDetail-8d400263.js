import{o as C,r as f,g,u as w,a as i,j as t,M as I,c as S,m as P,p as M,I as $,d as j,h as z,k as y}from"./index-fb9d91aa.js";import{P as B}from"./AppBack-1f281241.js";import{P as R}from"./PlaySongsBar-bfa9ed98.js";import{u as U}from"./useScrollTop-09fc1e57.js";import{u as D,c as E}from"./clamp-0151734b.js";const L=({name:o,description:n,subscribedCount:e,playCount:c,tags:m})=>{const{isShowModal:p,isShowContent:r,onModalOpen:u,onModalClose:s}=M();return i("div",{children:[p&&t($,{isDynamic:!1,children:i("div",{className:j(" fixed left-0 top-0 p-9 text-base bg-mg text-fg pb-16 transition-opacity duration-300 z-[10000] w-full h-full",{" opacity-100":r," opacity-0":!r}),children:[i("div",{className:" inline-block w-1/2 text-fg",children:[t("div",{className:"count text-center text-2xl font-bold",children:c}),t("div",{className:"text-center text-sm mt-2",children:"播放"})]}),i("div",{className:" inline-block w-1/2 text-fg",children:[t("div",{className:"count text-center text-2xl font-bold",children:e}),t("div",{className:"text-center text-sm mt-2",children:"订阅"})]}),t("div",{className:" min-h-[20px] max-h-[80%] overflow-y-auto mt-4 text-base leading-normal text-dg ",children:n}),t("div",{onClick:s,"data-close":"true",className:" absolute bottom-10 text-fg text-center text-4xl w-full left-0",children:"×"})]})}),t("div",{className:" leading-snug font-bold text-fg text-xl two_lines",children:o}),t("div",{className:" single_line text-sm leading-snug text-dg mt-5",onClick:u,children:n}),t("div",{className:" mt-5 flex flex-wrap",children:m.map(l=>t(z,{text:l,style:{position:"relative",top:"initial",bottom:"initial",left:"initial",right:"initial",marginTop:10,marginRight:8}},l))})]})},H=()=>{const{playlistid:o}=C(),n=f.useRef(null),{data:e}=g(`/api/playlist/detail?id=${o}`,()=>y.get(`/api/playlist/detail?id=${o}`).then(s=>{const{playlist:l}=s.data,{coverImgUrl:a,tags:d,subscribedCount:x,playCount:h,name:b,description:v,trackIds:N}=l;return{coverImgUrl:a,tags:d,subscribedCount:x,playCount:h,name:b,description:v??"",trackIds:N.map(k=>k.id)}})),{data:c}=g(e?.trackIds?`/api/song/detail?ids=${e.trackIds.slice(0,100).join()}`:"",()=>e?y.get(`/api/song/detail?ids=${e.trackIds.slice(0,100).join()}`).then(s=>{const{songs:l}=s.data;return l.map(a=>{const d=a.ar.length?[...a.ar].reverse().reduce((x,h)=>`${h.name} ${x}`,""):"";return{imgUrl:a.al.picUrl?a.al.picUrl.replace(/https?/,"https"):"",title:`${a.name}`,desc:d,artistId:a.ar[0].id,albumId:a.al.id,artistName:d,albumName:a.al.name,type:"song",id:a.id}})}):null),m=f.useCallback(s=>{const l=E(s,0,1);return l===0?2:Number(l.toFixed(2))},[]),p=f.useCallback(()=>n.current,[]),r=D(p,m),u=w();return U(),i("div",{className:" pt-8 px-4 pb-10",children:[t("div",{className:" fixed pt-6 px-4 pb-4 top-0 left-0 w-full z-[501] bg-mg",style:{opacity:r},children:t(B,{isBlack:!1,title:e?.name??"",style:{padding:0}})}),t("div",{className:" mt-12 sticky z-0 top-4 flex justify-center",children:t(I,{url:e?.coverImgUrl||"",className:" w-[180px] h-[180px] rounded"})}),i("div",{className:" sticky py-8 bg-mg z-[5] overflow-hidden",ref:n,children:[t(L,{name:e?.name??"",description:e?.description??"",subscribedCount:e?.subscribedCount??"",playCount:e?.playCount??0,tags:e?.tags??[]}),i("div",{className:" mt-8",children:[t(R,{songsCount:c?.length??0,withoutBar:!1,onPlayIconClick:()=>{u(S.actions.playSongs(c??[]))}}),t("div",{className:" mt-6 pl-1",children:t(P,{list:c??void 0,placeHolderCount:8})})]})]})]})};export{H as default};
