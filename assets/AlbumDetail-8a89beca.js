import{o as b,r as x,g as N,u as v,a as l,j as e,M as y,c as C,m as k,p as w,I as M,d as D,A as S,k as I}from"./index-f9106632.js";import{d as Y}from"./dayjs.min-62ef9dcb.js";import{P}from"./AppBack-1fc16a25.js";import{u as U}from"./useScrollTop-14632921.js";import{u as $,c as z}from"./clamp-e6db275f.js";import{P as j}from"./PlaySongsBar-9b0f18e9.js";const A=({shareCount:c,likedCount:r,desc:t,publishTime:d,name:m,artist:s})=>{const{isShowModal:u,isShowContent:i,onModalOpen:a,onModalClose:p}=w();return l("div",{children:[u&&e(M,{isDynamic:!1,children:l("div",{className:D(" fixed left-0 top-0 p-9 text-base bg-mg text-fg pb-16 transition-opacity duration-300 z-[10000] w-full h-full",{" opacity-100":i," opacity-0":!i}),children:[l("div",{className:" inline-block w-1/2 text-fg",children:[e("div",{className:"count text-center text-2xl font-bold",children:c}),e("div",{className:"text-center text-sm mt-2",children:"播放"})]}),l("div",{className:" inline-block w-1/2 text-fg",children:[e("div",{className:"count text-center text-2xl font-bold",children:r}),e("div",{className:"text-center text-sm mt-2",children:"点赞"})]}),e("div",{className:" min-h-[20px] max-h-[80%] overflow-y-auto mt-4 text-base leading-normal text-dg ",children:t}),e("div",{onClick:p,"data-close":"true",className:" absolute bottom-10 text-fg text-center text-4xl w-full left-0",children:"×"})]})}),e("div",{className:" text-base text-dg font-bold single_line w-full text-left",children:d}),e("div",{className:" mt-3 text-xl text-fg single_line w-full",children:m}),e("div",{className:" mt-5",children:e(S,{imgUrl:s?.imgUrl??"",lazyLoading:!0,artistName:s?.artistName??"",desc:s?.desc??"",id:s?.id??0})}),e("div",{className:" min-h-[20px] max-h-[86%] overflow-y-auto mt-5 text-sm leading-snug text-dg single_line ",onClick:a,children:t})]})},L=()=>{const{albumid:c}=b(),r=x.useRef(null),{data:t}=N(`/api/album?id=${c}`,()=>I.get(`/api/album?id=${c}`).then(i=>{const{album:a,songs:p}=i.data,{artist:n,description:g,alias:h,info:f}=a;return{picUrl:a.picUrl,publishTime:Y(new Date(a.publishTime),"YYYY-MM-DD").format("YYYY-MM-DD"),name:`${a.name}${h[0]?`(${h[0]})`:""}`,artist:{imgUrl:a.artist.picUrl,artistName:`${n.name}`,desc:n.alias[0]?`(${n.alias[0]})`:"",id:n.id},shareCount:f.shareCount,likedCount:f.likedCount,desc:g??"",songs:p.map(o=>({title:o.name,id:o.id,desc:n.name,artistName:n.name,albumName:o.al.name,albumId:o.al.id,artistId:o.ar[0].id,type:"song",noImg:!0}))}})),d=x.useCallback(i=>{const a=z(i,0,1);return a===0?2:Number(a.toFixed(2))},[]),m=x.useCallback(()=>r.current,[]),s=$(m,d),u=v();return U(),console.log("albumDetails",t),l("div",{className:" pt-8 px-4 pb-10",children:[e("div",{className:" fixed pt-6 px-4 pb-4 top-0 left-0 w-full z-[501] bg-mg",style:{opacity:s},children:e(P,{isBlack:!1,title:t?.name??"",style:{padding:0}})}),e("div",{className:" mt-12 sticky z-0 top-4 flex justify-center",children:e(y,{url:t?.picUrl||"",className:" w-[180px] h-[180px] rounded"})}),l("div",{className:" sticky py-8 bg-mg z-[5] overflow-hidden",ref:r,children:[e(A,{publishTime:t?.publishTime,name:t?.name,artist:t?.artist,desc:t?.desc,shareCount:t?.shareCount,likedCount:t?.likedCount}),l("div",{className:" mt-8",children:[e(j,{songsCount:t?.songs?.length??0,withoutBar:!1,onPlayIconClick:()=>{u(C.actions.playSongs(t?.songs??[]))}}),e("div",{className:" mt-6 pl-1",children:e(k,{list:t?.songs??void 0,placeHolderCount:8,lazyAll:!0,indexedPic:!0,more:!0})})]})]})]})};export{L as default};
