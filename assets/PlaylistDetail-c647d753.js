import{b as h,j as s,a as t,r as k}from"./index-03eb5bc5.js";import{u as g}from"./useQuery-dedb3b52.js";import{M as w,S as I,u as S,c as P,L as M}from"./MediaItemList-f2388cba.js";import{useDispatch as $}from"./index-a77eba25.js";import{P as j}from"./AppBack-7c94106c.js";import{a as y}from"./Spinner-4dd26406.js";import{P as z}from"./PlaySongsBar-6f85e5b6.js";import{u as B}from"./useScrollTop-55a76156.js";import{u as R,c as U}from"./clamp-c5ec07cf.js";import{I as D}from"./useIsomorphicEffect-6f95aa50.js";import{Z as L}from"./index-148c3eca.js";import"./extends-98964cd2.js";import"./inheritsLoose-54b40604.js";import"./index-89495b59.js";const E=({name:n,description:o,subscribedCount:e,playCount:r,tags:m})=>{const{isShowModal:p,isShowContent:c,onModalOpen:u,onModalClose:i}=S();return s("div",{children:[p&&t(D,{isDynamic:!1,children:s("div",{className:P(" fixed left-0 top-0 p-9 text-base bg-mg text-fg pb-16 transition-opacity duration-300 z-[10000] w-full h-full",{" opacity-100":c," opacity-0":!c}),children:[s("div",{className:" inline-block w-1/2 text-fg",children:[t("div",{className:"count text-center text-2xl font-bold",children:r}),t("div",{className:"text-center text-sm mt-2",children:"播放"})]}),s("div",{className:" inline-block w-1/2 text-fg",children:[t("div",{className:"count text-center text-2xl font-bold",children:e}),t("div",{className:"text-center text-sm mt-2",children:"订阅"})]}),t("div",{className:" min-h-[20px] max-h-[80%] overflow-y-auto mt-4 text-base leading-normal text-dg ",children:o}),t("div",{onClick:i,"data-close":"true",className:" absolute bottom-10 text-fg text-center text-4xl w-full left-0",children:"×"})]})}),t("div",{className:" leading-snug font-bold text-fg text-xl two_lines",children:n}),t("div",{className:" single_line text-sm leading-snug text-dg mt-5",onClick:u,children:o}),t("div",{className:" mt-5 flex flex-wrap",children:m.map(l=>t(M,{text:l,style:{position:"relative",top:"initial",bottom:"initial",left:"initial",right:"initial",marginTop:10,marginRight:8}},l))})]})},X=()=>{const{playlistid:n}=L(),o=h.useRef(null),{data:e}=g(`/api/playlist/detail?id=${n}`,()=>y.get(`/api/playlist/detail?id=${n}`).then(i=>{const{playlist:l}=i.data,{coverImgUrl:a,tags:d,subscribedCount:f,playCount:x,name:b,description:v,trackIds:N}=l;return{coverImgUrl:a,tags:d,subscribedCount:f,playCount:x,name:b,description:v??"",trackIds:N.map(C=>C.id)}})),{data:r}=g(e?.trackIds?`/api/song/detail?ids=${e.trackIds.slice(0,100).join()}`:"",()=>e?y.get(`/api/song/detail?ids=${e.trackIds.slice(0,100).join()}`).then(i=>{const{songs:l}=i.data;return l.map(a=>{const d=a.ar.length?[...a.ar].reverse().reduce((f,x)=>`${x.name} ${f}`,""):"";return{imgUrl:a.al.picUrl?a.al.picUrl.replace(/https?/,"https"):"",title:`${a.name}`,desc:d,artistId:a.ar[0].id,albumId:a.al.id,artistName:d,albumName:a.al.name,type:"song",id:a.id}})}):null),m=h.useCallback(i=>{const l=U(i,0,1);return l===0?2:Number(l.toFixed(2))},[]),p=h.useCallback(()=>o.current,[]),c=R(p,m),u=$();return B(),s("div",{className:" pt-8 px-4 pb-10",children:[t("div",{className:" fixed pt-6 px-4 pb-4 top-0 left-0 w-full z-[501] bg-mg",style:{opacity:c},children:t(j,{isBlack:!1,title:e?.name??"",style:{padding:0}})}),t("div",{className:" mt-12 sticky z-0 top-4 flex justify-center",children:t(w,{url:e?.coverImgUrl||"",className:" w-[180px] h-[180px] rounded"})}),s("div",{className:" sticky py-8 bg-mg z-[5] overflow-hidden",ref:o,children:[t(E,{name:e?.name??"",description:e?.description??"",subscribedCount:e?.subscribedCount??"",playCount:e?.playCount??0,tags:e?.tags??[]}),s("div",{className:" mt-8",children:[t(z,{songsCount:r?.length??0,withoutBar:!1,onPlayIconClick:()=>{u(k.actions.playSongs(r??[]))}}),t("div",{className:" mt-6 pl-1",children:t(I,{list:r??void 0,placeHolderCount:8})})]})]})]})};export{X as default};
