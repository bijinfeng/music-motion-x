import{b as f,j as l,a as e,r as b}from"./index-401e96bf.js";import{d as N}from"./dayjs.min-93c519eb.js";import{u as v}from"./useQuery-99551319.js";import{M as y,S as C,u as w,c as k,A as M}from"./MediaItemList-ed246fbe.js";import{useDispatch as S}from"./index-ce8fa1cc.js";import{a as D}from"./Spinner-aae6f266.js";import{P as I}from"./AppBack-b69646a4.js";import{u as Y}from"./useScrollTop-12429a99.js";import{u as P,c as U}from"./clamp-c6bed481.js";import{P as $}from"./PlaySongsBar-12147b54.js";import{I as z}from"./useIsomorphicEffect-e0594a54.js";import{Z as j}from"./index-b43b7b60.js";import"./extends-98964cd2.js";import"./inheritsLoose-54b40604.js";import"./index-6bea7a43.js";const A=({shareCount:r,likedCount:c,desc:t,publishTime:m,name:d,artist:s})=>{const{isShowModal:u,isShowContent:i,onModalOpen:a,onModalClose:p}=w();return l("div",{children:[u&&e(z,{isDynamic:!1,children:l("div",{className:k(" fixed left-0 top-0 p-9 text-base bg-mg text-fg pb-16 transition-opacity duration-300 z-[10000] w-full h-full",{" opacity-100":i," opacity-0":!i}),children:[l("div",{className:" inline-block w-1/2 text-fg",children:[e("div",{className:"count text-center text-2xl font-bold",children:r}),e("div",{className:"text-center text-sm mt-2",children:"播放"})]}),l("div",{className:" inline-block w-1/2 text-fg",children:[e("div",{className:"count text-center text-2xl font-bold",children:c}),e("div",{className:"text-center text-sm mt-2",children:"点赞"})]}),e("div",{className:" min-h-[20px] max-h-[80%] overflow-y-auto mt-4 text-base leading-normal text-dg ",children:t}),e("div",{onClick:p,"data-close":"true",className:" absolute bottom-10 text-fg text-center text-4xl w-full left-0",children:"×"})]})}),e("div",{className:" text-base text-dg font-bold single_line w-full text-left",children:m}),e("div",{className:" mt-3 text-xl text-fg single_line w-full",children:d}),e("div",{className:" mt-5",children:e(M,{imgUrl:s?.imgUrl??"",lazyLoading:!0,artistName:s?.artistName??"",desc:s?.desc??"",id:s?.id??0})}),e("div",{className:" min-h-[20px] max-h-[86%] overflow-y-auto mt-5 text-sm leading-snug text-dg single_line ",onClick:a,children:t})]})},K=()=>{const{albumid:r}=j(),c=f.useRef(null),{data:t}=v(`/api/album?id=${r}`,()=>D.get(`/api/album?id=${r}`).then(i=>{const{album:a,songs:p}=i.data,{artist:o,description:g,alias:x,info:h}=a;return{picUrl:a.picUrl,publishTime:N(new Date(a.publishTime),"YYYY-MM-DD").format("YYYY-MM-DD"),name:`${a.name}${x[0]?`(${x[0]})`:""}`,artist:{imgUrl:a.artist.picUrl,artistName:`${o.name}`,desc:o.alias[0]?`(${o.alias[0]})`:"",id:o.id},shareCount:h.shareCount,likedCount:h.likedCount,desc:g??"",songs:p.map(n=>({title:n.name,id:n.id,desc:o.name,artistName:o.name,albumName:n.al.name,albumId:n.al.id,artistId:n.ar[0].id,type:"song",noImg:!0}))}})),m=f.useCallback(i=>{const a=U(i,0,1);return a===0?2:Number(a.toFixed(2))},[]),d=f.useCallback(()=>c.current,[]),s=P(d,m),u=S();return Y(),console.log("albumDetails",t),l("div",{className:" pt-8 px-4 pb-10",children:[e("div",{className:" fixed pt-6 px-4 pb-4 top-0 left-0 w-full z-[501] bg-mg",style:{opacity:s},children:e(I,{isBlack:!1,title:t?.name??"",style:{padding:0}})}),e("div",{className:" mt-12 sticky z-0 top-4 flex justify-center",children:e(y,{url:t?.picUrl||"",className:" w-[180px] h-[180px] rounded"})}),l("div",{className:" sticky py-8 bg-mg z-[5] overflow-hidden",ref:c,children:[e(A,{publishTime:t?.publishTime,name:t?.name,artist:t?.artist,desc:t?.desc,shareCount:t?.shareCount,likedCount:t?.likedCount}),l("div",{className:" mt-8",children:[e($,{songsCount:t?.songs?.length??0,withoutBar:!1,onPlayIconClick:()=>{u(b.actions.playSongs(t?.songs??[]))}}),e("div",{className:" mt-6 pl-1",children:e(C,{list:t?.songs??void 0,placeHolderCount:8,lazyAll:!0,indexedPic:!0,more:!0})})]})]})]})};export{K as default};
