import{r as c,n as R,j as g,M,g as q,a as I,d as A,z as X}from"./index-f9106632.js";const B=c.memo(c.forwardRef((N,w)=>{const{banners:o,onBannerChange:p}=N,h=c.useRef(),m=c.useRef(),r=c.useRef(null),l=c.useRef(0),y=c.useRef(0),a=c.useRef(0),$=c.useCallback(()=>{clearTimeout(h.current),clearTimeout(m.current)},[]),C=c.useCallback(()=>{const t=l.current,e=(t+1)%o.length,n=r.current?.childNodes?.[t],s=r.current?.childNodes?.[e];if(!n||!s)return;n.style.transition="none",s.style.transition="none",n.style.transform=`translate3d(${-100*t}%, 0, 0)`,s.style.transform=`translate3d(${100-100*e}%, 0, 0)`,s.style.transform=`${s.style.transform}scale(0.8)`;const i=()=>{n.style.transition="",s.style.transition="",n.style.transform=`translate3d(${-100-100*t}%, 0, 0)`,n.style.transform=`${n.style.transform}scale(0.8)`,s.style.transform=`translate3d(${-100*e}%, 0, 0)`,l.current=e,p(l.current)};requestAnimationFrame(()=>{requestAnimationFrame(()=>{try{i()}catch(u){console.log(u)}})}),m.current=setTimeout(()=>{try{C()}catch(u){console.log(u)}},3e3)},[o.length,p]),b=c.useCallback(t=>{if(t!=null){p(t),$();const e=r.current?.childNodes?.[l.current];if(!e)return;e.style.transition="none",e.style.transform=`translate3d(${(o.length+1)*100}%, 0, 0)`;const n=r.current?.childNodes?.[t];n.style.transition="none",n.style.transform=`translate3d(${-100*t}%, 0, 0)`,l.current=t}else p(l.current);h.current=setTimeout(()=>{try{C()}catch(e){console.log(e)}},3e3)},[o.length,C,p,$]),L=c.useCallback(()=>{clearTimeout(h.current),b()},[b]),x=c.useCallback((t,e,n,s,i,u)=>{$(),y.current=t,e.style.transition="none",n.style.transition="none",s.style.transition="none",e.style.transform=`translate3d(${-a.current*l.current}px, 0, 0)`,n.style.transform=`translate3d(${-a.current-a.current*i}px, 0, 0)`,s.style.transform=`translate3d(${a.current-a.current*u}px, 0, 0)`},[$]),E=c.useCallback((t,e,n,s,i,u)=>{e.style.transform=`translate3d(${t-y.current-a.current*l.current}px, 0, 0)`,e.style.transform=`${e.style.transform}scale(${1-Math.abs((t-y.current)/(a.current*2.5))})`,n.style.transform=`translate3d(${t-y.current-a.current-a.current*i}px, 0, 0)`,n.style.transform=`${n.style.transform}scale(0.9)`,s.style.transform=`translate3d(${t-y.current+a.current-a.current*u}px, 0, 0)`,s.style.transform=`${s.style.transform}scale(0.9)`},[]),k=c.useCallback((t,e,n,s,i,u)=>{let d=0;t-y.current>a.current*.3?d=1:t-y.current<-a.current*.3&&(d=-1),e.style.transition="",n.style.transition="",s.style.transition="",e.style.transform=`translate3d(${d*a.current-a.current*l.current}px, 0, 0)`,n.style.transform=`translate3d(${d*a.current-a.current-a.current*i}px, 0, 0)`,s.style.transform=`translate3d(${d*a.current+a.current-a.current*u}px, 0, 0)`,l.current=(l.current-d+o.length)%o.length,L()},[o.length,L]),P=c.useCallback(t=>{const e=(l.current-1+o.length)%o.length,n=(l.current+1)%o.length,s=r.current?.childNodes?.[l.current],i=r.current?.childNodes?.[e],u=r.current?.childNodes?.[n];x(t.clientX,s,i,u,e,n);const d=f=>{E(f.clientX,s,i,u,e,n)},v=f=>{k(f.clientX,s,i,u,e,n),r.current.removeEventListener("mousemove",d),r.current.removeEventListener("mouseup",v),r.current.removeEventListener("mouseleave",v)};r.current.addEventListener("mousemove",d),r.current.addEventListener("mouseup",v),r.current.addEventListener("mouseleave",v)},[o.length,k,E,x]),T=c.useCallback(()=>{r.current.addEventListener("mousedown",P),r.current.addEventListener("touchstart",t=>{t.cancelable&&t.preventDefault();const e=(l.current-1+o.length)%o.length,n=(l.current+1)%o.length,s=r.current?.childNodes?.[l.current],i=r.current?.childNodes?.[e],u=r.current?.childNodes?.[n];x(t.changedTouches[0].pageX,s,i,u,e,n);const d=f=>{f.cancelable&&f.preventDefault(),E(f.changedTouches[0].pageX,s,i,u,e,n)},v=f=>{k(f.changedTouches[0].pageX,s,i,u,e,n),r.current.removeEventListener("touchmove",d),r.current.removeEventListener("touchend",v)};r.current.addEventListener("touchmove",d,{passive:!1}),r.current.addEventListener("touchend",v,{passive:!0})},{passive:!0})},[o.length,P,k,E,x]);return R(()=>{b(),requestAnimationFrame(()=>{a.current=parseInt(getComputedStyle(r.current).width,10),T()})},[T,b]),c.useImperativeHandle(w,()=>({nextPic:b})),g("div",{ref:r,className:" absolute w-full top-0 left-0 whitespace-nowrap touch-pan-x",children:o.map((t,e)=>g("div",{className:" w-full inline-block transition-transform ease-in-out duration-700 scale-100 ",children:e===0?g("img",{className:" w-full rounded-[10px]",src:t?t.replace(/https?/,"https"):"",alt:"",draggable:!1}):g(M,{url:t,className:" w-full rounded-[10px]"})},e))})}));B.displayName="MyBanner";const j=c.memo(()=>{const[N,w]=c.useState(0),o=c.useRef({nextPic:m=>{}}),p=c.useCallback(m=>{w(m)},[]),{data:h}=q("/api/banner?type=2",X);return I("div",{className:" w-full relative overflow-hidden",style:{padding:"39% 0 0"},"data-testid":"test-banners",children:[g("div",{className:" absolute bottom-1 left-1/2 -translate-x-1/2 z-20 will-change-transform",children:h?.map((m,r)=>g("li",{className:A(" mr-1 w-[6px] h-[6px] inline-block rounded-[50%]",{"bg-secondary":N===r," bg-white":N!==r}),onClick:()=>{o.current.nextPic(r)}},r))}),!!h&&h?.length>0&&g(B,{banners:h.map(m=>m.pic?m.pic.replace(/https?/,"https"):""),onBannerChange:p,ref:o})]})});j.displayName="Banners";export{j as default};
