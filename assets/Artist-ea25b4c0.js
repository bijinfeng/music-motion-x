import{b as d,j as m,a as t,F as C}from"./index-03eb5bc5.js";import{Link as h}from"./index-89495b59.js";import{u as n}from"./useQuery-dedb3b52.js";import{u as k,c as S,M as D,a as c,S as I,B as U,d as Y}from"./MediaItemList-f2388cba.js";import{d as j}from"./dayjs.min-d9433ffa.js";import{a as p}from"./Spinner-4dd26406.js";import{P as z}from"./AppBack-7c94106c.js";import{u as A,c as T}from"./clamp-c5ec07cf.js";import{I as B}from"./useIsomorphicEffect-6f95aa50.js";import{u as F}from"./useScrollTop-55a76156.js";import{Z as L}from"./index-148c3eca.js";import"./extends-98964cd2.js";import"./inheritsLoose-54b40604.js";import"./index-a77eba25.js";const X=()=>{const{artistid:l}=L(),u=d.useRef(null),{isShowModal:x,isShowContent:f,onModalOpen:g,onModalClose:b}=k(),{data:r}=n(`/api/artists?id=${l}`,()=>p.get(`/api/artists?id=${l}`).then(e=>e.data).then(e=>{const{artist:i,hotSongs:a}=e;return{artist:{imgUrl:i.picUrl,title:i?.alias?.[0]??"",id:i.id,artistName:i.name,type:"artist",desc:i.briefDesc},songs:a.map(s=>({imgUrl:s.al.picUrl,title:s.name,desc:s.al.name,artistId:s.ar[0].id,albumId:s.al.id,artistName:s.ar.length?[...s.ar].reverse().reduce((M,$)=>`${$.name} ${M}`,""):"",albumName:s.al.name,type:"song",id:s.id}))}})),{data:y}=n(`/api/artist/album?id=${l}&offset=0&limit=4`,()=>p.get(`/api/artist/album?id=${l}&offset=0&limit=4`).then(e=>e.data).then(e=>{const{hotAlbums:i}=e;return i.map(a=>({imgUrl:a.picUrl,title:a.name,publishTime:a.publishTime?j(new Date(a.publishTime),"YYYY-MM-DD").format("YYYY-MM-DD"):null,type:"bigAlbum",albumId:a.id,id:a.id}))})),{data:o}=n(`/api/artist/mv?id=${l}&offset=0&limit=4`,()=>p.get(`/api/artist/mv?id=${l}&offset=0&limit=4`).then(e=>e.data).then(e=>{const{mvs:i}=e;return i.map(a=>({imgUrl:a.imgurl,title:a.name,id:a.id,desc:a.description,type:"mv"}))})),v=d.useCallback(e=>{const i=T(e,0,1);return i===0?2:Number(i.toFixed(2))},[]),w=d.useCallback(()=>u.current,[]),N=A(w,v);return F(),console.log(o),m("div",{className:" pt-8 px-4 pb-10",children:[x&&t(B,{isDynamic:!1,children:m("div",{className:S(" fixed left-0 top-0 p-9 text-base bg-mg text-fg pb-16 transition-opacity duration-300 z-[10000] w-full h-full",{" opacity-100":f," opacity-0":!f}),children:[t("div",{className:" min-h-[20px] max-h-[80%] overflow-y-auto mt-4 text-base leading-normal text-dg ",children:r?.artist?.desc}),t("div",{onClick:b,"data-close":"true",className:" absolute bottom-10 text-fg text-center text-4xl w-full left-0",children:"×"})]})}),t("div",{className:" fixed pt-6 px-4 pb-4 top-0 left-0 w-full z-[501] bg-mg",style:{opacity:N},children:t(z,{isBlack:!1,title:r?.artist?.artistName??"",style:{padding:0}})}),t("div",{className:" mt-16 sticky z-0 top-4 flex justify-center",children:t(D,{url:r?.artist?.imgUrl||"",className:" w-[134px] h-[134px] rounded-[50%]"})}),m("div",{className:" sticky py-8 bg-mg z-[5] overflow-hidden",ref:u,children:[t("div",{className:" mt-3 text-xl text-fg single_line w-full",children:`${r?.artist?.artistName} (${r?.artist?.title})`}),t("div",{className:" min-h-[20px] max-h-[86%] overflow-y-auto mt-5 text-base leading-snug text-dg two_lines ",onClick:g,children:r?.artist?.desc}),t(h,{to:`/artist/media/${l}/song`,children:t(c,{title:"热曲",showMore:!0})}),t(I,{list:r?.songs?.slice?.(0,5)??void 0,placeHolderCount:5,lazyAll:!0}),t(h,{to:`/artist/media/${l}/album`,children:t(c,{title:"热门专辑",showMore:!0})}),t(U,{list:y??void 0,placeHolderCount:4}),!!o&&o?.length>0&&m(C,{children:[t(c,{title:"热门MV"}),t("div",{className:"flex flex-wrap  justify-between",children:t(Y,{list:o??void 0,placeHolderCount:4})})]})]})]})};export{X as default};
