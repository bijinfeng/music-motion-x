import{n as b,r as x,e as N,u as v,a as s,j as e,M as y,l as C,o as w,I as k,c as M,A as S,i as D}from"./index-db6e8751.js";import{d as I}from"./dayjs.min-4b4bf20c.js";import{P as Y}from"./AppBack-ecf3a4ca.js";import{u as P}from"./useScrollTop-f1d24d8b.js";import{u as U,c as $}from"./clamp-9656cb9b.js";import{P as z}from"./PlaySongsBar-f262d836.js";const j=({shareCount:r,likedCount:c,desc:t,publishTime:d,name:m,artist:i})=>{const{isShowModal:u,isShowContent:l,onModalOpen:a,onModalClose:p}=w();return s("div",{children:[u&&e(k,{isDynamic:!1,children:s("div",{className:M(" fixed left-0 top-0 p-9 text-base bg-mg text-fg pb-16 transition-opacity duration-300 z-[10000] w-full h-full",{" opacity-100":l," opacity-0":!l}),children:[s("div",{className:" inline-block w-1/2 text-fg",children:[e("div",{className:"count text-center text-2xl font-bold",children:r}),e("div",{className:"text-center text-sm mt-2",children:"播放"})]}),s("div",{className:" inline-block w-1/2 text-fg",children:[e("div",{className:"count text-center text-2xl font-bold",children:c}),e("div",{className:"text-center text-sm mt-2",children:"点赞"})]}),e("div",{className:" min-h-[20px] max-h-[80%] overflow-y-auto mt-4 text-base leading-normal text-dg ",children:t}),e("div",{onClick:p,"data-close":"true",className:" absolute bottom-10 text-fg text-center text-4xl w-full left-0",children:"×"})]})}),e("div",{className:" text-base text-dg font-bold single_line w-full text-left",children:d}),e("div",{className:" mt-3 text-xl text-fg single_line w-full",children:m}),e("div",{className:" mt-5",children:e(S,{imgUrl:i?.imgUrl??"",lazyLoading:!0,artistName:i?.artistName??"",desc:i?.desc??"",id:i?.id??0})}),e("div",{className:" min-h-[20px] max-h-[86%] overflow-y-auto mt-5 text-sm leading-snug text-dg single_line ",onClick:a,children:t})]})},F=()=>{const{albumid:r}=b(),c=x.useRef(null),{data:t}=N(`/api/album?id=${r}`,()=>D.get(`/api/album?id=${r}`).then(l=>{const{album:a,songs:p}=l.data,{artist:n,description:g,alias:f,info:h}=a;return{picUrl:a.picUrl,publishTime:I(new Date(a.publishTime),"YYYY-MM-DD").format("YYYY-MM-DD"),name:`${a.name}${f[0]?`(${f[0]})`:""}`,artist:{imgUrl:a.artist.picUrl,artistName:`${n.name}`,desc:n.alias[0]?`(${n.alias[0]})`:"",id:n.id},shareCount:h.shareCount,likedCount:h.likedCount,desc:g??"",songs:p.map(o=>({title:o.name,id:o.id,desc:n.name,artistName:n.name,albumName:o.al.name,albumId:o.al.id,artistId:o.ar[0].id,type:"song",noImg:!0}))}})),d=x.useCallback(l=>{const a=$(l,0,1);return a===0?2:Number(a.toFixed(2))},[]),m=x.useCallback(()=>c.current,[]),i=U(m,d),u=v(l=>l.playSongs);return P(),console.log("albumDetails",t),s("div",{className:" pt-8 px-4 pb-10",children:[e("div",{className:" fixed pt-6 px-4 pb-4 top-0 left-0 w-full z-[501] bg-mg",style:{opacity:i},children:e(Y,{isBlack:!1,title:t?.name??"",style:{padding:0}})}),e("div",{className:" mt-12 sticky z-0 top-4 flex justify-center",children:e(y,{url:t?.picUrl||"",className:" w-[180px] h-[180px] rounded"})}),s("div",{className:" sticky py-8 bg-mg z-[5] overflow-hidden",ref:c,children:[e(j,{publishTime:t?.publishTime,name:t?.name,artist:t?.artist,desc:t?.desc,shareCount:t?.shareCount,likedCount:t?.likedCount}),s("div",{className:" mt-8",children:[e(z,{songsCount:t?.songs?.length??0,withoutBar:!1,onPlayIconClick:()=>{u(t?.songs??[])}}),e("div",{className:" mt-6 pl-1",children:e(C,{list:t?.songs??void 0,placeHolderCount:8,lazyAll:!0,indexedPic:!0,more:!0})})]})]})]})};export{F as default};
